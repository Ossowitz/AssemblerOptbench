# Работа оптимизирующего компилятора

![img.png](img.png)

## Отказ от цикла

### Кода на языке C

```c
for (i = 0; i < 3; i++) ivector[i] = 1;
```

### Неоптимизированный код

```asm
	mov     DWORD PTR i[rip], 0     # Инициализируем переменную i
	jmp     .L2                     # Переходим на проверку условия в .L2
.L3:
	mov     eax, DWORD PTR i[rip]   # Загружаем значение переменной i
	cdqe                            # Расширяем значение в регистре до 64 бит
	lea     rdx, 0[0+rax*4]         # Вычисляем адрес элемента и сохраняем его
	lea     rax, ivector[rip]       # Загружаем адрес массива
	mov     DWORD PTR [rdx+rax], 1  # Устанавливаем значение 1
	
	mov     eax, DWORD PTR i[rip]   # Загружаем значение переменной i
	add     eax, 1                  # Увеличиваем значение переменной на 1
	mov     DWORD PTR i[rip], eax   # Сохраняем новое значение переменной 
.L2:
	mov     eax, DWORD PTR i[rip]   # Загружаем значение переменной i
	cmp     eax, 2                  # Сравниваем значение i с 2 (меньше или равно)
	jle     .L3                     # Если меньше или равно, то переходим в .L3
```

#### Комментарий относительно неоптимизированного кода:

В неоптимизированном варианте происходит 3 проверки и 3 передачи управления